graph TD
    subgraph "Client Layer"
        Client[Client Applications]
    end
    
    subgraph "Gateway Layer"
        GM[GraphQL Mesh Gateway]
        GS[Schema-stitching Gateway]
        HG[Hive Gateway]
    end
    
    subgraph "Microservices Layer"
        UserService[User Microservice]
        ExpenseService[Expense Tracker Microservice]
    end
    
    subgraph "Data Storage"
        UserDB[(User Database)]
        ExpenseDB[(Expense Database)]
        SchemaRegistry[(Schema Registry)]
    end
    
    %% Client connections
    Client -->|GraphQL Query| GM
    Client -->|GraphQL Query| GS
    Client -->|GraphQL Query| HG
    
    %% Gateway connections
    GM -->|Forward Queries| UserService
    GM -->|Forward Queries| ExpenseService
    GS -->|Forward Queries| UserService
    GS -->|Forward Queries| ExpenseService
    HG -->|Forward Queries| UserService
    HG -->|Forward Queries| ExpenseService
    
    %% Hive specific connections
    HG <-->|Schema Management| SchemaRegistry
    
    %% Service connections
    UserService -->|CRUD Operations| UserDB
    ExpenseService -->|CRUD Operations| ExpenseDB
    
    %% Cross-service data requirements
    ExpenseService -.->|User Data Lookup| UserService
    UserService -.->|Expense Data Lookup| ExpenseService
    
    %% Labels
    classDef gateway fill:#f9f,stroke:#333,stroke-width:2px
    classDef service fill:#bbf,stroke:#333,stroke-width:1px
    classDef database fill:#dfd,stroke:#333,stroke-width:1px
    
    class GM,GS,HG gateway
    class UserService,ExpenseService service
    class UserDB,ExpenseDB,SchemaRegistry database